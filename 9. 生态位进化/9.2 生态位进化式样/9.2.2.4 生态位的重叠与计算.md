## 生态位的重叠与计算

### author：Tian

## 原理部分

### 1 环境空间的自相关性对于物种建模结果的影响

#### 1.1 栖息地的可用性与背景buffer之间的关系

```
之前计算的结果在3km和30km之间进行选择时结果差异并不是很显著，只是重叠值的计算上出现了较大差异，这种差异反映了栖息地的可用性；之前的结果显示的是在3km范围内的环境重叠值会显著小于30km的重叠值，这反映了在西藏沙棘在植物资源利用的上的领域性，也就是克隆的母体效应会在local尺度上产生地理型分割。换句话说，除了所观测到点分布之外，在分布的就近点西藏沙棘不会动态集群分布，这也在反向说明了西藏沙棘 传播问题的另一种解释，区域可利用性是造成西藏沙棘间隔分布的主要原因。这种区域可利用性主要体现在水分和太阳辐射等。
```

#### 1.2 利用地理距离的核密度聚类来确定合适的背景buffer

```
另外，我通过arcgis的核密度分析（之前需要对数据进行处理，生成30km的最小距离间隔），之后选择合适的核密度指数进行聚类分析。这样聚类的分类可以将剩下的数据可以划分为核心区和非核心区。实际上现今的植物分布无论是从否从核心区进行转移，这里的核心区也都会往往位于分布的中心，那必然会是后续传播的主要源。根据种群动态的原理，计算种群的分布聚类 。
```

##### 1.2.1 构建物种分布的最小面积

```
方法1：即利用maxent自带的各种最小面积计算方法来计算可获取的最小适生区面积

方法2：
```

#### 1.3 空间自相关的原理及检测

##### 1.3.1 原理

```
空间自相关最早是由美国科学家提出：
地理学第一定律（Tobler's First Law或者Tobler's First Law of Geography）Everything is related to everything else, but near things are more related to each other. [1]  （任何事物都是与其他事物相关的，只不过相近的事物关联更紧密）

基于空间自相关反映在环境空间的组合方面，可以更反映出基于环境组合对物种分布的 可能影响；此外这种可能的影响或许也具有十分重要的意义，反映了生境过滤的强度。
```

##### 1.3.2 检测方法——莫兰指数

```
常用的方法是：
## 参考以下博文：https://www.cnblogs.com/arcserver/p/10952157.html
如果适应莫兰指数测量某个因变量，发现具有显著的空间自相关效应，那么这样的特征除了可以分析因变量的空间分布特征外，如果要进一步分析该因变量同环境因子之间的关系，就需要对这样的空间自相关效应加以考虑。

这时候，如果要使用某个或某几个环境变量对此因变量进行回归分析，以检测环境因子与因变量的关系时，如果使用传统的OLS回归，就会导致存在空间自相关而增加犯第一类错误的风险，也就是拒绝原假设，得到的p值更小。因此需要考虑空间自相关，如果去除了空间自相关效应，有可能结果变得不显著了，P值增加，之前有相关性的两个变量，就变得不相关了。。。

那么，这样的因变量这样的空间分布特征产生的原由，有两种，一个是因变量自身，一个是环境因子导致。当因变量自身的特征导致的空间结构时，就叫做空间自相关；如果该因变量的空间结构时环境因子导致的，则称为诱导性空间依赖。

因此，当我们发现莫兰指数显著大于期望时，探讨环境因子和因变量的关系就需要考虑这样的空间结构特征了。一般的，如果是由空间自相关产生的空间结构时，而且我们能够找到这样的空间结构（比如随着距离增加减小），那么使用该空间结构（比如距离）同因变量进行回归分析，残差理论上就会无空间自相关效应了（莫兰指数为接近期望，p值较大）。这时后的残差就是去除了空间自相关效应的，可以用此值同其他的环境因子进行回归分析，从而得到可靠的结果。

如果是由环境因子的结构特征导致的因变量空间结构特征时，也就是说某个环境因子的高低值导致了因变量的高低变化。那么对该变量进行回归分析，理论上得到的残差就会无空间自相关效应。

注意：真实的情况是，我们无法知道一个因变量的空间自相关效应是来自于其本身，还是来自于环境因子，或者二者都有一部分影响。但说过来，来自本身时可以用距离结构来消除，来自外部因子时可以使用外部因子来消除，如果把距离和外部因子视为外因子的话，就不存在空间自相关来自哪里的问题，只有如何有效减小的问题。

一个因变量的空间结构特征，在不同距离上有着不同的空间自相关值，那么找的合适的距离和空间结构，就可以有效去除空间自相关效应（还不太清楚如何处理）

介绍目前的常规做法：
首先，将你打算探索的数据整理好，我用arcgis处理，将因变量和环境因子放在一个图层的属性表里，该图层最好是polygon形式，而且需要注意，如果你要计算的queen形距离矩阵，就不要有破碎面，也就是没有邻近单元的单个斑块，这样的斑块邻近值为0。
其次，生成距离矩阵，在R里面处理，将图层导入R，并生成距离矩阵，距离矩阵有多种，有些对破碎斑块容忍度较好。
再次，使用OLS拟合因变量和环境变量。
第四，使用lm.LMtest函数检测模型参数，选择合适的模型
 第五，然后使用对应的函数处理因变量和环境因子，得到回归结果，解释回归结果。
一般使用的较多的有两种模型，空间滞后模型和空间误差模型，前者可以使用impacts函数统计环境因子和因变量之间的关系。后者不清楚如何处理。
参考：
https://eburchfield.github.io/files/Spatial_regression_LAB.html
```



### 2. 身份检测

目前所接触到的，基于生态位重叠检测的方法主要有三种：并且三种方法的对于身份检测的方法各不相同；最早关于生态位重叠的检测的来自于沃尔丹的enmtools包中的检测称之为identity test。此后布鲁尼和wenis各提出不同的假设检验方法用于确认近缘种的亲缘关系和生态位分化情况（或者说保守性）。

```
## 进行身份检测的目的：
身份检测的目的在于探究物种在分布区域内是否是随机选择的，其生态位重叠程度和背景研究区域的随机抽样结果有何区别？？

## 进行身份检测的结果
如果实际检测的生态位重叠和通过反复在背景检测区域的结果存在显著差异，那么就证明两近缘物种间生态位保守型特性是远高于随机环境背景抽样生成的伪物种的结果。也就是很大程度上说明这些被比较的近缘种很大程度上是异域分布，占据不同的环境背景；

## 身份检测存在的问题：
	在不同的环境背景下，除了物种本身的内在属性差异外，物种的生态位差异主要体现在由扩散、生境过滤（非生物环境过滤（生态生理限制）和生物环境过滤（竞争等））。因此在异域环境生态位差异比较中，造成生态位差异的原因主要可能有两个：一是生物间的实际生态位（考虑到种间互作之后）差异，另一方面称之为由环境背景的空间自相关性产生。环境背景的空间自相关是指环境背景因子间会互相依赖，进而会在不用的区域背景下产生不同的局域环境组合（物种生存的有效生境）的环境生态位差异；
	也正是基于上述问题，开展身份测试不能否认空间自相关的作用。
	## 重新理解下，这里的意思是身份检测的结果可能是由于局域环境自相关造成的；

```

### 3.背景检测

#承接上文讲到的环境随机性检测的显著性结果可能是由于环境空间的自相关原因造成的，因此开发了基于环境背景置换的背景相似性检测；

```
相似性检测的方法是从perterson等对近缘种间鸟类可以利用气候包络进行相互预测的原理，在此基础上对物种周围的可利用空间进行投影，比较在资源可利用的情况下，近缘物种间的实际生态位与伪随机环境生态位之间的关系？如果两者之间差异显著，则可以说明观察到的物种之间的生态位差异是生境选择和/或适宜性的函数，而不仅仅是两个物种可利用的生境组合之间潜在环境差异的产物。也就是支持了生态位分化的假设，反之则不支持；
```

```

```

