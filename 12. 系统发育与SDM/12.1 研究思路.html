
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>12.1 研究思路 · NICHE MODEL 中文指南-RCODING</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="nicheerfeng">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="12.2 研究R包.html" />
    
    
    <link rel="prev" href="12. 系统发育与SDM说明.html" />
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"repo":"nicheerfeng/Nichefbook","types":["star"],"size":"small"};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Niche model 中文指南-Rcoding</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../1. 构建工作环境/1.1 构建工作环境说明.html">
            
                <a href="../1. 构建工作环境/1.1 构建工作环境说明.html">
            
                    
                    1. 构建工作环境
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../1. 构建工作环境/1.1 R-配置环境变量.html">
            
                <a href="../1. 构建工作环境/1.1 R-配置环境变量.html">
            
                    
                    1.1 加载及配置R工作环境
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../2.下载物种分布数据/2.下载物种分布数据说明.html">
            
                <a href="../2.下载物种分布数据/2.下载物种分布数据说明.html">
            
                    
                    2.下载物种分布数据
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../2.下载物种分布数据/2.1 物种分布数据网站.html">
            
                <a href="../2.下载物种分布数据/2.1 物种分布数据网站.html">
            
                    
                    2.1 物种分布数据网站
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../2.下载物种分布数据/2.2 使用R下载物种分布.html">
            
                <a href="../2.下载物种分布数据/2.2 使用R下载物种分布.html">
            
                    
                    2.2 使用R下载物种分布
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../3. 物种分布数据清理/物种分布数据清理.html">
            
                <a href="../3. 物种分布数据清理/物种分布数据清理.html">
            
                    
                    3. 物种分布数据清理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../3. 物种分布数据清理/3.1 R-清理分布数据.html">
            
                <a href="../3. 物种分布数据清理/3.1 R-清理分布数据.html">
            
                    
                    3.1 R-清理分布数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../3. 物种分布数据清理/3.2 构建物种丰富度栅格.html">
            
                <a href="../3. 物种分布数据清理/3.2 构建物种丰富度栅格.html">
            
                    
                    3.2 构建物种丰富度栅格
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../3. 物种分布数据清理/3.3 核平滑构建物种分布图.html">
            
                <a href="../3. 物种分布数据清理/3.3 核平滑构建物种分布图.html">
            
                    
                    3.3 核平滑构建物种分布图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../3. 物种分布数据清理/3.4 改变分布数据的投影方法.html">
            
                <a href="../3. 物种分布数据清理/3.4 改变分布数据的投影方法.html">
            
                    
                    3.4 改变分布数据的投影方法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../3. 物种分布数据清理/3.5 spthin降低采样偏差.html">
            
                <a href="../3. 物种分布数据清理/3.5 spthin降低采样偏差.html">
            
                    
                    3.5 spthin降低采样偏差
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../4. 下载环境数据/4.下载环境数据说明.html">
            
                <a href="../4. 下载环境数据/4.下载环境数据说明.html">
            
                    
                    4. 下载环境数据
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../4. 下载环境数据/4.1 环境数据网站.html">
            
                <a href="../4. 下载环境数据/4.1 环境数据网站.html">
            
                    
                    4.1 环境数据网站
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../4. 下载环境数据/R下载及处理环境数据.md">
            
                <span>
            
                    
                    4.2 R下载及处理环境数据
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../5. 模型数据预处理/5.模型数据预处理说明.html">
            
                <a href="../5. 模型数据预处理/5.模型数据预处理说明.html">
            
                    
                    5. 模型数据预处理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../5. 模型数据预处理/5.1 环境数据预处理/5.1 环境数据预处理.html">
            
                <a href="../5. 模型数据预处理/5.1 环境数据预处理/5.1 环境数据预处理.html">
            
                    
                    5.1 环境数据预处理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="../5. 模型数据预处理/5.1 环境数据预处理/5.1.1 读取及导出shp_raster.html">
            
                <a href="../5. 模型数据预处理/5.1 环境数据预处理/5.1.1 读取及导出shp_raster.html">
            
                    
                    5.1.1 读取及导出shp_raster
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.2" data-path="../5. 模型数据预处理/5.1 环境数据预处理/5.1.2 栅格数据的基本处理.html">
            
                <a href="../5. 模型数据预处理/5.1 环境数据预处理/5.1.2 栅格数据的基本处理.html">
            
                    
                    5.1.2 栅格数据的基本处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.3" data-path="../5. 模型数据预处理/5.1 环境数据预处理/5.1.3 补充和报错处理.html">
            
                <a href="../5. 模型数据预处理/5.1 环境数据预处理/5.1.3 补充和报错处理.html">
            
                    
                    5.1.3 补充和报错处理
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../5. 模型数据预处理/5.2 模型分布数据预处理/5.2 模型分布数据预处理.html">
            
                <a href="../5. 模型数据预处理/5.2 模型分布数据预处理/5.2 模型分布数据预处理.html">
            
                    
                    5.2 模型分布数据预处理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="../5. 模型数据预处理/5.2 模型分布数据预处理/5.2.1 构建训练集和测试集.html">
            
                <a href="../5. 模型数据预处理/5.2 模型分布数据预处理/5.2.1 构建训练集和测试集.html">
            
                    
                    5.2.1 构建训练集和测试集
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="../5. 模型数据预处理/5.2 模型分布数据预处理/5.2.2 构建背景数据集.html">
            
                <a href="../5. 模型数据预处理/5.2 模型分布数据预处理/5.2.2 构建背景数据集.html">
            
                    
                    5.2.2 构建背景数据集
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="../5. 模型数据预处理/5.2 模型分布数据预处理/5.2.3 筛选环境因子.html">
            
                <a href="../5. 模型数据预处理/5.2 模型分布数据预处理/5.2.3 筛选环境因子.html">
            
                    
                    5.2.3 筛选环境因子.md
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../6. SDM运行/6.SDM运行说明.html">
            
                <a href="../6. SDM运行/6.SDM运行说明.html">
            
                    
                    6. SDM运行
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../6. SDM运行/6.1 SDM运行.html">
            
                <a href="../6. SDM运行/6.1 SDM运行.html">
            
                    
                    6.1 SDM运行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../6. SDM运行/6.2 SDM结果展示.html">
            
                <a href="../6. SDM运行/6.2 SDM结果展示.html">
            
                    
                    6.2 SDM结果展示
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../6. SDM运行/6.3 SDM模型评估.html">
            
                <a href="../6. SDM运行/6.3 SDM模型评估.html">
            
                    
                    6.3 SDM模型评估
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../6. SDM运行/6.4 SDM模型外推.html">
            
                <a href="../6. SDM运行/6.4 SDM模型外推.html">
            
                    
                    6.4 SDM模型外推
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../6. SDM运行/6.5 SDM整合建模.html">
            
                <a href="../6. SDM运行/6.5 SDM整合建模.html">
            
                    
                    6.5 SDM整合建模
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../6. SDM运行/6. SDM运行说明.md">
            
                <span>
            
                    
                    6.6 SDM案例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.6.1" data-path="../6. SDM运行/6.6 SDM案例/6.6.1bioclim.html">
            
                <a href="../6. SDM运行/6.6 SDM案例/6.6.1bioclim.html">
            
                    
                    bioclim
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.2" data-path="../6. SDM运行/6.6 SDM案例/6.6.2biomod2工作流.html">
            
                <a href="../6. SDM运行/6.6 SDM案例/6.6.2biomod2工作流.html">
            
                    
                    biomod2工作流
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.3" data-path="../6. SDM运行/6.6 SDM案例/6.6.3ENMEVAAL.html">
            
                <a href="../6. SDM运行/6.6 SDM案例/6.6.3ENMEVAAL.html">
            
                    
                    ENMEVAAL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.4" data-path="../6. SDM运行/6.6 SDM案例/6.6.4enmSDM工作流.html">
            
                <a href="../6. SDM运行/6.6 SDM案例/6.6.4enmSDM工作流.html">
            
                    
                    enmSDM工作流
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.5" data-path="../6. SDM运行/6.6 SDM案例/6.6.5hypervolume.html">
            
                <a href="../6. SDM运行/6.6 SDM案例/6.6.5hypervolume.html">
            
                    
                    hypervolume
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.6" data-path="../6. SDM运行/6.6 SDM案例/6.6.6maxent工作流.html">
            
                <a href="../6. SDM运行/6.6 SDM案例/6.6.6maxent工作流.html">
            
                    
                    maxent工作流
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6.7" data-path="../6. SDM运行/6.6 SDM案例/6.6.7SDMtune工作流.html">
            
                <a href="../6. SDM运行/6.6 SDM案例/6.6.7SDMtune工作流.html">
            
                    
                    SDMtune工作流
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../7. SDM相关数据可视化/7.SDM相关数据可视化说明.html">
            
                <a href="../7. SDM相关数据可视化/7.SDM相关数据可视化说明.html">
            
                    
                    7. SDM相关数据可视化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../7. SDM相关数据可视化/7.1 R包地图底图.html">
            
                <a href="../7. SDM相关数据可视化/7.1 R包地图底图.html">
            
                    
                    7.1 R包地图底图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../7. SDM相关数据可视化/7.2 地图数据三维可视化.html">
            
                <a href="../7. SDM相关数据可视化/7.2 地图数据三维可视化.html">
            
                    
                    7.2 地图数据三维可视化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../7. SDM相关数据可视化/7.3 栅格数据可视化.html">
            
                <a href="../7. SDM相关数据可视化/7.3 栅格数据可视化.html">
            
                    
                    7.3 栅格数据可视化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../7. SDM相关数据可视化/7.4 多维环境变量可视化.html">
            
                <a href="../7. SDM相关数据可视化/7.4 多维环境变量可视化.html">
            
                    
                    7.4 多维环境变量可视化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../7. SDM相关数据可视化/7.5 SDM结果可视化.html">
            
                <a href="../7. SDM相关数据可视化/7.5 SDM结果可视化.html">
            
                    
                    7.5 SDM结果可视化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="../7. SDM相关数据可视化/7.6 可视化物种分布.html">
            
                <a href="../7. SDM相关数据可视化/7.6 可视化物种分布.html">
            
                    
                    7.6 可视化物种分布
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7" data-path="../7. SDM相关数据可视化/7.7 相关性分析.html">
            
                <a href="../7. SDM相关数据可视化/7.7 相关性分析.html">
            
                    
                    7.7 相关性分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../8. SDM-workflow说明/8.SDM-workflow说明.html">
            
                <a href="../8. SDM-workflow说明/8.SDM-workflow说明.html">
            
                    
                    8. SDM-workflow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../8. SDM-workflow说明/8.1 workflow的基本流程.html">
            
                <a href="../8. SDM-workflow说明/8.1 workflow的基本流程.html">
            
                    
                    8.1 workflow的基本流程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../8. SDM-workflow说明/8.2 workflow的基础知识.html">
            
                <a href="../8. SDM-workflow说明/8.2 workflow的基础知识.html">
            
                    
                    8.2 workflow的基础知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../8. SDM-workflow说明/8.3 workflow的全流程R包.html">
            
                <a href="../8. SDM-workflow说明/8.3 workflow的全流程R包.html">
            
                    
                    8.3 workflow的全流程R包
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../8. SDM-workflow说明/8.4 workflow的专项R包及脚本.html">
            
                <a href="../8. SDM-workflow说明/8.4 workflow的专项R包及脚本.html">
            
                    
                    8.4 workflow的专项R包及脚本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../8. SDM-workflow说明/8.5 workflow.GUI.html">
            
                <a href="../8. SDM-workflow说明/8.5 workflow.GUI.html">
            
                    
                    8.5 workflow(GUI)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../8. SDM-workflow说明/8.6 案例.html">
            
                <a href="../8. SDM-workflow说明/8.6 案例.html">
            
                    
                    8.6 案例
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../9. 生态位进化/9.生态位进化说明.html">
            
                <a href="../9. 生态位进化/9.生态位进化说明.html">
            
                    
                    9. 生态位进化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1 生态位宽度的进化.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/9.1 生态位宽度的进化.html">
            
                    
                    9.1 生态位宽度的进化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1.1" data-path="../9. 生态位进化/9.1 生态位宽度的进化/生态位宽度基础概念.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/生态位宽度基础概念.html">
            
                    
                    9.1 生态位宽度的进化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.1.2" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1.1 单因素分析/9.1.1 单因素分析.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/9.1.1 单因素分析/9.1.1 单因素分析.html">
            
                    
                    9.1.1 单因素分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1.2.1" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1.1 单因素分析/参数和及非参.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/9.1.1 单因素分析/参数和及非参.html">
            
                    
                    参数和及非参统计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.1.2.2" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1.1 单因素分析/方差分析结果可视化.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/9.1.1 单因素分析/方差分析结果可视化.html">
            
                    
                    方差分析结果可视化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.1.3" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/9.1.2 多因素分析.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/9.1.2 多因素分析.html">
            
                    
                    9.1.2 多因素分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1.3.1" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/CCA.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/CCA.html">
            
                    
                    CCA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.1.3.2" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/PCA_MANOVA.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/PCA_MANOVA.html">
            
                    
                    PCA_MANOVA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.1.3.3" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/聚类分析.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/聚类分析.html">
            
                    
                    聚类分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.1.3.4" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/生态位轴PCA得分.html">
            
                <a href="../9. 生态位进化/9.1 生态位宽度的进化/9.1.2 多因素分析/生态位轴PCA得分.html">
            
                    
                    生态位轴PCA得分
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.1.4" data-path="../9. 生态位进化/9.1 生态位宽度的进化/9.1.3 超维度分析R-多维超体积生态位.md">
            
                <span>
            
                    
                    9.1.3 超维度分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2 生态位进化式样说明.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2 生态位进化式样说明.html">
            
                    
                    9.2 生态位进化式样
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.2.1" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2.1 生态位进化式样.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2.1 生态位进化式样.html">
            
                    
                    9.2.1 生态位进化式样
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2.2" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2.2 ecospat.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2.2 ecospat.html">
            
                    
                    9.2.2 ecospat
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.2.2.1" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2.2.1 优化可视化_raw.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2.2.1 优化可视化_raw.html">
            
                    
                    9.2.2.1 优化可视化_raw
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2.2.2" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2.2.2 优化可视化2.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2.2.2 优化可视化2.html">
            
                    
                    9.2.2.2 优化可视化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2.2.3" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2.2.3 生态位保守性测试.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2.2.3 生态位保守性测试.html">
            
                    
                    9.2.2.3 生态位保守性测试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2.2.4" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2.2.4 生态位的重叠与计算.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2.2.4 生态位的重叠与计算.html">
            
                    
                    9.2.2.4 生态位的重叠与计算
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2.2.5" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2.2.5 生态位重叠可视化.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2.2.5 生态位重叠可视化.html">
            
                    
                    9.2.2.5 生态位重叠可视化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2.2.6" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2.2.6 非矫正.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2.2.6 非矫正.html">
            
                    
                    9.2.2.6 非矫正生态位重叠
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.2.3" data-path="../9. 生态位进化/9.2 生态位进化式样/9.2.3 ENMtools.html">
            
                <a href="../9. 生态位进化/9.2 生态位进化式样/9.2.3 ENMtools.html">
            
                    
                    9.2.3 ENMtools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../9. 生态位进化/9.3 扩散动态研究/9.3 扩散动态研究.html">
            
                <a href="../9. 生态位进化/9.3 扩散动态研究/9.3 扩散动态研究.html">
            
                    
                    9.3 扩散动态研究
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../10. 群落与SDM/10. 群落生态学说明.html">
            
                <a href="../10. 群落与SDM/10. 群落生态学说明.html">
            
                    
                    10. 群落与SDM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../10. 群落生态学/10.1 背景资料.md">
            
                <span>
            
                    
                    10.1 背景资料
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../10. 群落与SDM/10.2 多物种联合建模.html">
            
                <a href="../10. 群落与SDM/10.2 多物种联合建模.html">
            
                    
                    10.2 多物种联合建模
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../10. 群落与SDM/10.3 经典研究案例.html">
            
                <a href="../10. 群落与SDM/10.3 经典研究案例.html">
            
                    
                    10.3 经典研究案例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../10. 群落与SDM/10.4 可视化.html">
            
                <a href="../10. 群落与SDM/10.4 可视化.html">
            
                    
                    10.4 可视化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../11. 遥感与SDM/11. 遥感与SDM说明.html">
            
                <a href="../11. 遥感与SDM/11. 遥感与SDM说明.html">
            
                    
                    11.遥感与SDM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../11. 遥感与SDM/11.1 研究思路.html">
            
                <a href="../11. 遥感与SDM/11.1 研究思路.html">
            
                    
                    11.1 研究思路
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../11. 遥感与SDM/11.2 研究R包.html">
            
                <a href="../11. 遥感与SDM/11.2 研究R包.html">
            
                    
                    11.2 研究R包
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../11. 遥感与SDM/11.3 经典研究案例.html">
            
                <a href="../11. 遥感与SDM/11.3 经典研究案例.html">
            
                    
                    11.3 经典研究案例
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="12. 系统发育与SDM说明.html">
            
                <a href="12. 系统发育与SDM说明.html">
            
                    
                    12.系统发育与SDM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.13.1" data-path="12.1 研究思路.html">
            
                <a href="12.1 研究思路.html">
            
                    
                    12.1 研究思路
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="12.2 研究R包.html">
            
                <a href="12.2 研究R包.html">
            
                    
                    12.2 研究R包
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="12.3 经典研究案例.html">
            
                <a href="12.3 经典研究案例.html">
            
                    
                    12.3 经典研究案例
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../13. 空间生态位/13. 空间生态位.html">
            
                <a href="../13. 空间生态位/13. 空间生态位.html">
            
                    
                    13.空间生态位
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../13. 空间生态位/13.1 R-空间统计书籍.html">
            
                <a href="../13. 空间生态位/13.1 R-空间统计书籍.html">
            
                    
                    13.1 R-空间统计书籍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../13. 空间生态位/13.2 空间自相关概念释义.html">
            
                <a href="../13. 空间生态位/13.2 空间自相关概念释义.html">
            
                    
                    13.2 空间自相关概念释义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="../13. 空间生态位/13.3 地统计.html">
            
                <a href="../13. 空间生态位/13.3 地统计.html">
            
                    
                    13.3 地统计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="../13. 空间生态位/13.4 案例.html">
            
                <a href="../13. 空间生态位/13.4 案例.html">
            
                    
                    13.4 案例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.5" data-path="../13. 空间生态位/13.5 R-解决空间自相关.html">
            
                <a href="../13. 空间生态位/13.5 R-解决空间自相关.html">
            
                    
                    13.5 R-解决空间自相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.6" data-path="../13. 空间生态位/13.6 补充.html">
            
                <a href="../13. 空间生态位/13.6 补充.html">
            
                    
                    13.6 补充
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../14. 生态位基础资料/14.生态位理论资料说明.html">
            
                <a href="../14. 生态位基础资料/14.生态位理论资料说明.html">
            
                    
                    14.生态位理论资料
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../14. 生态位基础资料/14.1 生态相关的名词释义.html">
            
                <a href="../14. 生态位基础资料/14.1 生态相关的名词释义.html">
            
                    
                    14.1 生态相关的名词释义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="../14. 生态位基础资料/14.2 SDM建模书籍.html">
            
                <a href="../14. 生态位基础资料/14.2 SDM建模书籍.html">
            
                    
                    14.2 SDM建模书籍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="../14. 生态位基础资料/14.3 相关与因果.html">
            
                <a href="../14. 生态位基础资料/14.3 相关与因果.html">
            
                    
                    14.3 相关与因果
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4" data-path="../14. 生态位基础资料/14.4 分布数据清理的依据.html">
            
                <a href="../14. 生态位基础资料/14.4 分布数据清理的依据.html">
            
                    
                    14.4 分布数据清理的依据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.5" data-path="../14. 生态位基础资料/14.5 建模格局的二元性.html">
            
                <a href="../14. 生态位基础资料/14.5 建模格局的二元性.html">
            
                    
                    14.5 建模格局的二元性
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.6" data-path="../14. 生态位基础资料/14.6 niche常见错误.html">
            
                <a href="../14. 生态位基础资料/14.6 niche常见错误.html">
            
                    
                    14.6 niche常见错误
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7" data-path="../14. 生态位基础资料/14.7 气候生态位的思路.html">
            
                <a href="../14. 生态位基础资料/14.7 气候生态位的思路.html">
            
                    
                    14.7 气候生态位的思路
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.8" data-path="../14. 生态位基础资料/14.8 环境与物种分布的交互选择.html">
            
                <a href="../14. 生态位基础资料/14.8 环境与物种分布的交互选择.html">
            
                    
                    14.8 环境与物种分布的交互选择
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../15. niche领航员工作/15.niche领航员工作.html">
            
                <a href="../15. niche领航员工作/15.niche领航员工作.html">
            
                    
                    15.niche领航员工作
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../15. niche领航员工作/乔慧捷.html">
            
                <a href="../15. niche领航员工作/乔慧捷.html">
            
                    
                    乔慧捷
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="../15. niche领航员工作/朱耿平.html">
            
                <a href="../15. niche领航员工作/朱耿平.html">
            
                    
                    朱耿平
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="../15. niche领航员工作/邬建国.html">
            
                <a href="../15. niche领航员工作/邬建国.html">
            
                    
                    邬建国
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4" data-path="../15. niche领航员工作/Andrew Townsend Peterson.html">
            
                <a href="../15. niche领航员工作/Andrew Townsend Peterson.html">
            
                    
                    Andrew Townsend Peterson
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.5" data-path="../15. niche领航员工作/Annette Ostling.html">
            
                <a href="../15. niche领航员工作/Annette Ostling.html">
            
                    
                    Annette Ostling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.6" data-path="../15. niche领航员工作/Antoine Guisan.html">
            
                <a href="../15. niche领航员工作/Antoine Guisan.html">
            
                    
                    Antoine Guisan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.7" data-path="../15. niche领航员工作/Damaris Zurell.html">
            
                <a href="../15. niche领航员工作/Damaris Zurell.html">
            
                    
                    Damaris Zurell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.8" data-path="../15. niche领航员工作/Dan L. Warre.html">
            
                <a href="../15. niche领航员工作/Dan L. Warre.html">
            
                    
                    Dan L. Warren
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.9" data-path="../15. niche领航员工作/Erin E. Saupe.html">
            
                <a href="../15. niche领航员工作/Erin E. Saupe.html">
            
                    
                    Erin E. Saupe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.10" data-path="../15. niche领航员工作/Holt R D.html">
            
                <a href="../15. niche领航员工作/Holt R D.html">
            
                    
                    Holt R D
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.11" data-path="../15. niche领航员工作/Hannah Lois Owens.html">
            
                <a href="../15. niche领航员工作/Hannah Lois Owens.html">
            
                    
                    Hannah Lois Owens
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.12" data-path="../15. niche领航员工作/Jane Elith.html">
            
                <a href="../15. niche领航员工作/Jane Elith.html">
            
                    
                    Jane Elith
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.13" data-path="../15. niche领航员工作/Jorge Soberón.html">
            
                <a href="../15. niche领航员工作/Jorge Soberón.html">
            
                    
                    Jorge Soberón
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.14" data-path="../15. niche领航员工作/Olivier Broennimann.html">
            
                <a href="../15. niche领航员工作/Olivier Broennimann.html">
            
                    
                    Olivier Broennimann
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.15" data-path="../15. niche领航员工作/Jane Elith.html">
            
                <a href="../15. niche领航员工作/Jane Elith.html">
            
                    
                    John J. Wiens
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.16" data-path="../15. niche领航员工作/Robert P. Anderson.html">
            
                <a href="../15. niche领航员工作/Robert P. Anderson.html">
            
                    
                    Robert P. Anderson
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.17" data-path="../15. niche领航员工作/Michael R Kearney.html">
            
                <a href="../15. niche领航员工作/Michael R Kearney.html">
            
                    
                    Michael R Kearne
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >12.1 研究思路</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x4E0E;&#x7269;&#x79CD;&#x5206;&#x5E03;&#x6A21;&#x578B;code">&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x4E0E;&#x7269;&#x79CD;&#x5206;&#x5E03;&#x6A21;&#x578B;code</h3>
<h3 id="&#x4E0B;&#x8F7D;&#x57FA;&#x56E0;&#x5E8F;&#x5217;-r">&#x4E0B;&#x8F7D;&#x57FA;&#x56E0;&#x5E8F;&#x5217; _R</h3>
<pre><code class="lang-r"><span class="hljs-comment">## &#x4E0B;&#x8F7D;&#x57FA;&#x56E0;&#x5E8F;&#x5217; _R</span>

<span class="hljs-keyword">library</span>(ape)
d &lt;- read.csv(<span class="hljs-string">&quot;c:/Users/admin/Desktop/&#x6784;&#x67B6;&#x6C99;&#x68D8;&#x5C5E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;/gene.csv&quot;</span>)

<span class="hljs-comment">### &#x4E0B;&#x8F7D;&#x5E8F;&#x5217;&#xFF1A;####</span>
t &lt;- c(paste0(<span class="hljs-string">&quot;hsal_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),paste0(<span class="hljs-string">&quot;hgya_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),paste0(<span class="hljs-string">&quot;hneu_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),paste0(<span class="hljs-string">&quot;hste_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),paste0(<span class="hljs-string">&quot;htib_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),
       paste0(<span class="hljs-string">&quot;hyun_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),paste0(<span class="hljs-string">&quot;hsin_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),paste0(<span class="hljs-string">&quot;htur_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),paste0(<span class="hljs-string">&quot;hmon_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),paste0(<span class="hljs-string">&quot;hcau_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),
       paste0(<span class="hljs-string">&quot;hfulu_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">3</span>),paste0(<span class="hljs-string">&quot;hcar_&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">2</span>),paste0(<span class="hljs-string">&quot;hrha_&quot;</span>,<span class="hljs-number">1</span>),<span class="hljs-string">&quot;triflora_1&quot;</span>,<span class="hljs-string">&quot;umbellata_1&quot;</span>,<span class="hljs-string">&quot;argentea_1&quot;</span>)

<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">39</span>){
  sal1 &lt;- d[i,-<span class="hljs-number">1</span>] %&gt;% as.character()
  z = read.GenBank(sal1 )
  route &lt;- paste0(<span class="hljs-string">&quot;c:/Users/admin/Desktop/&quot;</span>,t[i],<span class="hljs-string">&quot;.fas&quot;</span>)
  write.dna(z,file =route,format = <span class="hljs-string">&quot;fasta&quot;</span>) <span class="hljs-comment">#&#x5C06;&#x5E8F;&#x5217;&#x4EE5;fasta&#x683C;&#x5F0F;&#x8F93;&#x51FA;</span>
}
</code></pre>
<h3 id="&#x8BFB;&#x53D6;&#x53CA;&#x5199;&#x51FA;&#x5E8F;&#x5217;">&#x8BFB;&#x53D6;&#x53CA;&#x5199;&#x51FA;&#x5E8F;&#x5217;</h3>
<pre><code class="lang-R">setwd(<span class="hljs-string">&quot;c:/Users/admin/Desktop/&#x6784;&#x67B6;&#x6C99;&#x68D8;&#x5C5E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;/&#x4E0B;&#x8F7D;&#x5E8F;&#x5217;/&quot;</span>)
<span class="hljs-keyword">library</span>(ape)
t1 &lt;- read.FASTA(<span class="hljs-string">&quot;./hcar_1.fas&quot;</span>)

t2 &lt;- read.FASTA(<span class="hljs-string">&quot;./hcar_2.fas&quot;</span>)

names(t1) &lt;- c(paste0(<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">5</span>))

nn &lt;- (t1[<span class="hljs-number">1</span>],t2[<span class="hljs-number">1</span>])

write.dna(nn,file =<span class="hljs-string">&quot;../try1.fas&quot;</span>,format = <span class="hljs-string">&quot;fasta&quot;</span>) <span class="hljs-comment">#&#x5C06;&#x5E8F;&#x5217;&#x4EE5;fasta&#x683C;&#x5F0F;&#x8F93;&#x51FA;</span>
</code></pre>
<h3 id="&#x6784;&#x5EFA;&#x53CA;&#x53EF;&#x89C6;&#x5316;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;">&#x6784;&#x5EFA;&#x53CA;&#x53EF;&#x89C6;&#x5316;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;</h3>
<pre><code class="lang-R">setwd(<span class="hljs-string">&quot;c:/Users/admin/Desktop/&#x6784;&#x67B6;&#x6C99;&#x68D8;&#x5C5E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;/&#x4E0B;&#x8F7D;&#x5E8F;&#x5217;/&quot;</span>)
<span class="hljs-keyword">library</span>(ape)
t1 &lt;- read.FASTA(<span class="hljs-string">&quot;./hcar_1.fas&quot;</span>)

t2 &lt;- read.FASTA(<span class="hljs-string">&quot;./hcar_2.fas&quot;</span>)

names(t1) &lt;- c(paste0(<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">5</span>))

nn &lt;- (t1[<span class="hljs-number">1</span>],t2[<span class="hljs-number">1</span>])


write.dna(nn,file =<span class="hljs-string">&quot;../try1.fas&quot;</span>,format = <span class="hljs-string">&quot;fasta&quot;</span>) <span class="hljs-comment">#&#x5C06;&#x5E8F;&#x5217;&#x4EE5;fasta&#x683C;&#x5F0F;&#x8F93;&#x51FA;</span>
<span class="hljs-comment">#### &#x6784;&#x5EFA;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811; ####</span>
<span class="hljs-keyword">library</span>(ape)
<span class="hljs-keyword">library</span>(treeio)
<span class="hljs-keyword">library</span>(ggtree)

<span class="hljs-keyword">library</span>(treeio)
da1 &lt;- read.nexus(file = <span class="hljs-string">&apos;c:/Users/admin/Desktop/mcc.species(1).txt&apos;</span>)

beast &lt;- read.beast(<span class="hljs-string">&apos;c:/Users/admin/Desktop/mcc.species(1).txt&apos;</span>)
beast@data$posterior




keepers &lt;- c(<span class="hljs-string">&quot;umbellata&quot;</span>, <span class="hljs-string">&quot;triflora&quot;</span>, <span class="hljs-string">&quot;argentea&quot;</span>, 
             <span class="hljs-string">&quot;hste&quot;</span>, <span class="hljs-string">&quot;hneu&quot;</span>, <span class="hljs-string">&quot;hsal&quot;</span>,<span class="hljs-string">&quot;hgya&quot;</span>,<span class="hljs-string">&quot;htib&quot;</span>,<span class="hljs-string">&quot;hcar&quot;</span>)

da2 &lt;- ape::drop.tip(phy = beast@phylo,tip = beast@phylo$tip.label[beast@phylo$tip.label %<span class="hljs-keyword">in</span>% keepers])

beast@data$posterior %&gt;% length()
da2$
plot(da2)

beast@phylo$tip.label %&gt;% length()

ggtree(beast) + geom_tiplab(geom = <span class="hljs-string">&quot;text&quot;</span>,size = <span class="hljs-number">2.5</span>) + 
  geom_nodepoint() + geom_n

<span class="hljs-comment">## &#x8BA1;&#x7B97;&#x5206;&#x5316;&#x65F6;&#x95F4;&#x8DDD;&#x79BB;&#xFF1A;</span>
cophenetic.phylo(da2)

<span class="hljs-comment">## &#x53EF;&#x4EE5;&#x63D0;&#x53D6;&#x5730;&#x7406;&#x77E9;&#x9635;&#xFF0C;&#x57FA;&#x4E8E;mcp</span>



<span class="hljs-comment">## &#x8BFB;&#x53D6;&#x5206;&#x5B50;&#x6811;&#xFF1A;</span>
dax &lt;- read.nexus(file = <span class="hljs-string">&apos;c:/Users/admin/Desktop/mcc.species(1).txt&apos;</span>)


<span class="hljs-comment">## &#x4F7F;&#x7528;ggtree&#x7ED8;&#x5236;&#x53EF;&#x89C6;&#x5316;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</span>

<span class="hljs-comment"># &#x8BFB;&#x53D6;&#x6570;&#x636E;&#x7684;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;</span>
<span class="hljs-comment"># beast_tree &lt;- read.beast(&apos;c:/Users/admin/Desktop/mcc.species(1).txt&apos;)</span>
<span class="hljs-comment"># &#x67E5;&#x770B;&#x6811;&#x5185;&#x90E8;&#x7684;&#x7ED3;&#x679C; &#xFF1A;</span>

da2$edge
da2$edge.length
da2$Nnode

<span class="hljs-comment">## &#x6539;&#x8FDB;&#x5B9E;&#x9A8C; &#xFF1A;</span>
da2$tip.label &lt;-  toupper(da2$tip.label)
p1 &lt;- ggtree(da2) + theme_tree2()
p1 +  scale_x_continuous(breaks = c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>:<span class="hljs-number">7</span>),labels = abs)
p2 = revts(p1) +  scale_x_continuous(breaks = c(-<span class="hljs-number">6</span>:<span class="hljs-number">0</span>),labels = paste0(<span class="hljs-number">6</span>:<span class="hljs-number">0</span>,<span class="hljs-string">&quot;Ma&quot;</span>))
p2 +  geom_tiplab(geom = <span class="hljs-string">&quot;text&quot;</span>,size = <span class="hljs-number">2.5</span>) +geom_nodepoint()

getwd()
png(<span class="hljs-string">&quot;&#x9F20;&#x674E;&#x6C99;&#x68D8;6.png&quot;</span>,width =<span class="hljs-number">2500</span>, height = <span class="hljs-number">1000</span>,res =<span class="hljs-number">300</span>)
p2 +  geom_tiplab(geom = <span class="hljs-string">&quot;text&quot;</span>,size = <span class="hljs-number">2.5</span>) +geom_nodepoint()
dev.off()

<span class="hljs-comment">## &#x4F18;&#x5316;&#x53EF;&#x89C6;&#x5316; ##</span>
<span class="hljs-comment">#&#x5C06;&#x6570;&#x636E;&#x5206;&#x4E3A;&#x4E09;&#x7EC4;&#xFF1A;</span>
<span class="hljs-comment"># &#x4E2D;&#x56FD;/&#x4E91;&#x5357;/&#x8499;&#x53E4;&#x5206;&#x4E3A;&#x4E00;&#x7EC4; &#xFF1B;</span>
<span class="hljs-comment"># &#x4E2D;&#x4E9A;&#x548C;&#x8499;&#x53E4;&#x5206;&#x4E3A;&#x4E00;&#x7EC4;&#xFF1B;</span>
<span class="hljs-comment"># &#x9AD8;&#x52A0;&#x7D22;&#x6C99;&#x68D8;&#x5206;&#x4E3A;&#x4E00;&#x7EC4;&#xFF1B;</span>
<span class="hljs-comment"># &#x6D77;&#x6EE8;&#x548C;&#x6EAA;&#x751F;&#x5206;&#x4E3A;&#x4E00;&#x7EC4;&#xFF1B;</span>


<span class="hljs-comment">## &#x53CD;&#x8F6C;&#x5750;&#x6807;&#x8F74;&#xFF1A;&#x591A;&#x5143;&#x53EF;&#x89C6;&#x5316; ## </span>
p3 &lt;- p2 +  geom_tiplab(geom = <span class="hljs-string">&quot;text&quot;</span>,size = <span class="hljs-number">2.5</span>) +geom_nodepoint()

p3 

<span class="hljs-comment"># add tip points</span>
p3 + geom_tippoint()

<span class="hljs-comment"># Label the tips ,&#x67E5;&#x770B;&#x5BF9;&#x5E94;&#x7684;&#x6807;&#x7B7E;&#xFF1A;###</span>
p3 + geom_tiplab()

<span class="hljs-comment"># &#x67E5;&#x770B;&#x5206;&#x7C7B;&#x540E;&#x7684;&#x6807;&#x7B7E;&#xFF1F;&#x53EF;&#x540E;&#x7EED;&#x7528;&#x4E8E;&#x53EF;&#x89C6;&#x5316; ##</span>
p3 + geom_text(aes(label=node), hjust=-<span class="hljs-number">.3</span>)

<span class="hljs-comment">## &#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;&#x8FDB;&#x884C;&#x5206;&#x7C7B; ##</span>
<span class="hljs-comment">## &#x65B9;&#x6CD5;1 &#x6839;&#x636E;&#x8282;&#x70B9;&#x5BF9;&#x5E94;&#x7684;&#x4F4D;&#x7F6E;&#x8BBE;&#x7F6E;&#x5BF9;&#x5E94;&#x7684;&#x989C;&#x8272; ##</span>
p3 +geom_tiplab() + 
  geom_hilight(node=<span class="hljs-number">11</span>, fill=<span class="hljs-string">&quot;gold&quot;</span>) + 
  geom_hilight(node=<span class="hljs-number">13</span>, fill=<span class="hljs-string">&quot;purple&quot;</span>)

<span class="hljs-comment">##  &#x65B9;&#x6CD5;2 &#x6839;&#x636E;&#x8282;&#x70B9;&#x5BF9;&#x5E94;&#x7684;&#x4F4D;&#x7F6E;&#x8BBE;&#x7F6E;&#x5BF9;&#x5E94;&#x7684;&#x5206;&#x7C7B;&#x7EBF;&#xFF1A;</span>
p3 + 
  geom_tiplab() + 
  geom_cladelabel(node=<span class="hljs-number">13</span>, label=<span class="hljs-string">&quot;Some random clade&quot;</span>, 
                  color=<span class="hljs-string">&quot;red2&quot;</span>, offset=<span class="hljs-number">.8</span>, align=<span class="hljs-literal">TRUE</span>) 

<span class="hljs-comment">## &#x65B9;&#x6CD5;3&#xFF1A;&#x6839;&#x636E;&#x6570;&#x636E;&#x6807;&#x7B7E;&#x94FE;&#x63A5;&#x5BF9;&#x5E94;&#x7684;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;&#x6807;&#x7B7E;&#x4F4D;&#x7F6E;&#xFF1A;</span>
p3 + geom_tiplab() + 
  geom_taxalink(<span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;H&quot;</span>, color=<span class="hljs-string">&quot;blue3&quot;</span>) +
  geom_taxalink(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;G&quot;</span>, color=<span class="hljs-string">&quot;orange2&quot;</span>, curvature=-<span class="hljs-number">.9</span>)

<span class="hljs-comment">## &#x6DFB;&#x52A0;&#x65F6;&#x95F4;&#x8F74;&#xFF1A;</span>
p3 + 
  theme_tree2() + 
  geom_tiplab(align=<span class="hljs-literal">TRUE</span>, linesize=<span class="hljs-number">.5</span>) + 
  xlim(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)

<span class="hljs-comment">## &#x53E6;&#x5916;&#x4E00;&#x79CD;&#x53EF;&#x89C6;&#x5316;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</span>
plot(da2)
<span class="hljs-comment">## &#x53EF;&#x89C6;&#x5316;&#x5BF9;&#x5E94;&#x7684;&#x8282;&#x70B9;&#x4F4D;&#x7F6E;&#xFF1A;</span>
<span class="hljs-comment"># nodelabels(da2$node.label, adj = 0, frame = &quot;n&quot;)</span>
time &lt;- da2$edge.length[-c(<span class="hljs-number">1</span>:<span class="hljs-number">7</span>)] %&gt;% round(<span class="hljs-number">2</span>)

nodelabels(time, frame = <span class="hljs-string">&quot;c&quot;</span>, bg = <span class="hljs-string">&quot;white&quot;</span>)
add.scale.bar(length = <span class="hljs-number">1</span> ,lwd = <span class="hljs-number">1.5</span>,labels = <span class="hljs-string">&quot;1Ma&quot;</span>)

plot(da1)
nodelabels(da1$node.label, adj = <span class="hljs-number">0</span>, frame = <span class="hljs-string">&quot;n&quot;</span>)

p3 &lt;- p2 +  geom_tiplab(geom = <span class="hljs-string">&quot;text&quot;</span>,size = <span class="hljs-number">1</span>) +geom_nodepoint()
p3 + geom_text(aes(label=node), hjust=-<span class="hljs-number">.3</span>)

<span class="hljs-comment">## &#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;&#x8FDB;&#x884C;&#x5206;&#x7C7B; ##</span>
<span class="hljs-comment">## &#x65B9;&#x6CD5;1 &#x6839;&#x636E;&#x8282;&#x70B9;&#x5BF9;&#x5E94;&#x7684;&#x4F4D;&#x7F6E;&#x8BBE;&#x7F6E;&#x5BF9;&#x5E94;&#x7684;&#x989C;&#x8272; ##</span>
p3 + geom_text(aes(label=node), hjust=-<span class="hljs-number">.3</span>) +
  geom_hilight(node=<span class="hljs-number">15</span>, fill=<span class="hljs-string">&quot;slateblue1&quot;</span>) + 
  geom_hilight(node=<span class="hljs-number">12</span>, fill=<span class="hljs-string">&quot;yellow&quot;</span>)

<span class="hljs-comment">##  &#x65B9;&#x6CD5;2 &#x6839;&#x636E;&#x8282;&#x70B9;&#x5BF9;&#x5E94;&#x7684;&#x4F4D;&#x7F6E;&#x8BBE;&#x7F6E;&#x5BF9;&#x5E94;&#x7684;&#x5206;&#x7C7B;&#x7EBF;&#xFF1A;</span>
p3 + geom_text(aes(label=node), hjust=-<span class="hljs-number">.3</span>) +
  geom_cladelabel(node=<span class="hljs-number">1</span>, label=<span class="hljs-string">&quot;&#x9AD8;&#x52A0;&#x901F;&#x5C71;&#x8109;&quot;</span>, 
                  color=<span class="hljs-string">&quot;red2&quot;</span>, offset=<span class="hljs-number">.8</span>, align=<span class="hljs-literal">TRUE</span>)
</code></pre>
<h3 id="&#x5C06;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;&#x6620;&#x5C04;&#x5230;&#x5730;&#x56FE;&#x4E2D;">&#x5C06;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;&#x6620;&#x5C04;&#x5230;&#x5730;&#x56FE;&#x4E2D;</h3>
<pre><code class="lang-r">
<span class="hljs-keyword">library</span>(phytools)
<span class="hljs-keyword">library</span>(mapdata)
<span class="hljs-keyword">library</span>(viridis)

srha &lt;-  read.csv(<span class="hljs-string">&quot;./F1_SP/thrid_po/srhar.csv&quot;</span>)[,<span class="hljs-number">3</span>:<span class="hljs-number">4</span>]
srha &lt;- srha[sample(nrow(srha), <span class="hljs-number">0.5</span>*nrow(srha)),]
head(hthi)

hs &lt;- rbind(scau,sflu,smon,srha,ssin,stur,syun) %&gt;% data.frame()
hs1 &lt;- cbind(hs$latitude,hs$longitude) %&gt;% data.frame()
names(hs1) &lt;- c(<span class="hljs-string">&quot;lat&quot;</span>,<span class="hljs-string">&quot;long&quot;</span>)
hs1 %&gt;% as.matrix() -&gt; hs1
va &lt;- c(rep(<span class="hljs-string">&quot;Hcau&quot;</span>,dim(scau)[<span class="hljs-number">1</span>]),rep(<span class="hljs-string">&quot;Hflu&quot;</span>,dim(sflu)[<span class="hljs-number">1</span>]),
        rep(<span class="hljs-string">&quot;Hmon&quot;</span>,dim(smon)[<span class="hljs-number">1</span>]),rep(<span class="hljs-string">&quot;Hrha&quot;</span>,dim(srha)[<span class="hljs-number">1</span>]),
        rep(<span class="hljs-string">&quot;Hsin&quot;</span>,dim(ssin)[<span class="hljs-number">1</span>]),
        rep(<span class="hljs-string">&quot;Htur&quot;</span>,dim(stur)[<span class="hljs-number">1</span>]),rep(<span class="hljs-string">&quot;Hyun&quot;</span>,dim(syun)[<span class="hljs-number">1</span>]))

row.names(hs1) &lt;- va

<span class="hljs-comment">## &#x8BBE;&#x5B9A;8&#x4E2A;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x4F4D;&#x7F6E;&#x5BF9;&#x5E94;&#x7684;&#x989C;&#x8272;&#xFF1A;</span>
coo &lt;- c(<span class="hljs-string">&quot;#66CC007f&quot;</span>,<span class="hljs-string">&quot;#9900FF7f&quot;</span>,<span class="hljs-string">&quot;#9999FF&quot;</span>,<span class="hljs-string">&quot;#FFCC007f&quot;</span>,<span class="hljs-string">&quot;#FF66667f&quot;</span>,
         <span class="hljs-string">&quot;#3333FF7f&quot;</span>,<span class="hljs-string">&quot;#FF33007f&quot;</span>)

cols  &lt;-setNames(coo,
                 da2$tip.label)
plot(da2)

<span class="hljs-comment">## &#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684;&#x5206;&#x5E03;&#x70B9;&#x56FE;&#x8303;&#x56F4;&#xFF1A;</span>
obj&lt;-phylo.to.map(da2,hs1,rotate  =<span class="hljs-literal">F</span> ,database=<span class="hljs-string">&quot;worldHires&quot;</span>,xlim = c(-<span class="hljs-number">7</span>,<span class="hljs-number">130</span>),ylim= c(<span class="hljs-number">20</span>,<span class="hljs-number">70</span>),
                  plot=<span class="hljs-literal">FALSE</span>,direction=<span class="hljs-string">&quot;downwards&quot;</span>)

plot(obj,direction=<span class="hljs-string">&quot;downwards&quot;</span>,colors=cols,cex.points=c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),rotate = <span class="hljs-literal">T</span>,
     lwd=c(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),ftype=<span class="hljs-string">&quot;i&quot;</span>)




png(<span class="hljs-string">&quot;c:/Users/admin/Desktop/&#x9F20;&#x674E;&#x6C99;&#x68D8;1.png&quot;</span>,width =<span class="hljs-number">2500</span>, height = <span class="hljs-number">1000</span>,res =<span class="hljs-number">300</span>)

plot(obj,direction=<span class="hljs-string">&quot;downwards&quot;</span>,colors=cols,cex.points=c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),rotate = <span class="hljs-literal">T</span>,
     lwd=c(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),ftype=<span class="hljs-string">&quot;i&quot;</span>)

dev.off()


png(<span class="hljs-string">&quot;c:/Users/admin/Desktop/&#x9F20;&#x674E;&#x6C99;&#x68D8;2.png&quot;</span>,width =<span class="hljs-number">2500</span>, height = <span class="hljs-number">1000</span>,res =<span class="hljs-number">300</span>)
<span class="hljs-comment">## &#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684;&#x8303;&#x56F4;mcp&#xFF1A;</span>
<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:Ntip(da2)){
  spr&lt;-hs1[which(rownames(hs1)==da2$tip.label[i]),]
  mcp&lt;-<span class="hljs-keyword">if</span>(i==<span class="hljs-number">1</span>) spr[chull(spr),] <span class="hljs-keyword">else</span> rbind(mcp,spr[chull(spr),])
}
plot(obj,direction=<span class="hljs-string">&quot;downwards&quot;</span>,colors=cols,cex.points=c(<span class="hljs-number">0</span>,<span class="hljs-number">0.6</span>),
     lwd=c(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),ftype=<span class="hljs-string">&quot;i&quot;</span>)

<span class="hljs-comment">## &#x4EC5;&#x7528;&#x4E8E;&#x53EF;&#x89C6;&#x5316;&#x8303;&#x56F4; &#xFF1A;</span>
<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:Ntip(da2)){
  ii&lt;-which(rownames(mcp)==da2$tip.label[i])
  polygon(mcp[ii,<span class="hljs-number">2</span>:<span class="hljs-number">1</span>],col=make.transparent(cols[da2$tip.label[i]],<span class="hljs-number">0.8</span>),
          border=<span class="hljs-string">&quot;darkgrey&quot;</span>)
}

obj&lt;-phylo.to.map(da2,mcp,database=<span class="hljs-string">&quot;worldHires&quot;</span>,xlim = c(-<span class="hljs-number">7</span>,<span class="hljs-number">130</span>),ylim= c(<span class="hljs-number">24</span>,<span class="hljs-number">70</span>),
                  plot=<span class="hljs-literal">FALSE</span>,direction=<span class="hljs-string">&quot;downwards&quot;</span>)

plot(obj,direction=<span class="hljs-string">&quot;downwards&quot;</span>,colors=cols,cex.points=c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),
     lwd=c(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>),ftype=<span class="hljs-string">&quot;i&quot;</span>)
</code></pre>
<h3 id="&#x6CBF;&#x65F6;&#x95F4;&#x8F74;&#x53EF;&#x89C6;&#x5316;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;">&#x6CBF;&#x65F6;&#x95F4;&#x8F74;&#x53EF;&#x89C6;&#x5316;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;</h3>
<pre><code class="lang-R"><span class="hljs-comment"># da2$tip.label &lt;-  toupper(da2$tip.label)</span>
p1 &lt;- ggtree(da2) + theme_tree2()
p1 +  scale_x_continuous(breaks = c(seq(<span class="hljs-number">0</span>,<span class="hljs-number">21</span>,<span class="hljs-number">2</span>)),labels = abs)
p2 = revts(p1) +  scale_x_continuous(breaks = c(seq(-<span class="hljs-number">20</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>)),
                                     labels = paste0(c(seq(<span class="hljs-number">20</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">2</span>)),<span class="hljs-string">&quot;Ma&quot;</span>))
p2 +  geom_tiplab(geom = <span class="hljs-string">&quot;text&quot;</span>,size = <span class="hljs-number">4</span>) +geom_nodepoint()

getwd()
png(<span class="hljs-string">&quot;&#x9F20;&#x674E;&#x6C99;&#x68D8;6.png&quot;</span>,width =<span class="hljs-number">3000</span>, height = <span class="hljs-number">1500</span>,res =<span class="hljs-number">300</span>)
p2 +  geom_tiplab(geom = <span class="hljs-string">&quot;text&quot;</span>,size = <span class="hljs-number">4</span>) +geom_nodepoint()
dev.off()
</code></pre>
<h3 id="&#x8BA1;&#x7B97;&#x7CFB;&#x7EDF;&#x53D1;&#x751F;&#x8DDD;&#x79BB;">&#x8BA1;&#x7B97;&#x7CFB;&#x7EDF;&#x53D1;&#x751F;&#x8DDD;&#x79BB;</h3>
<pre><code>## &#x8BA1;&#x7B97;&#x5206;&#x5316;&#x65F6;&#x95F4;&#x8DDD;&#x79BB;&#xFF1A;
timedist &lt;- cophenetic.phylo(da2)
</code></pre><h3 id="&#x57FA;&#x4E8E;ml&#x6811;&#xFF0C;&#x91CD;&#x5EFA;&#x5E74;&#x9F84;&#x91CD;&#x5EFA;&#x6811;">&#x57FA;&#x4E8E;ml&#x6811;&#xFF0C;&#x91CD;&#x5EFA;&#x5E74;&#x9F84;&#x91CD;&#x5EFA;&#x6811;</h3>
<pre><code class="lang-r"><span class="hljs-keyword">library</span>(ape)
ctrl &lt;- chronos.control(nb.rate.cat = <span class="hljs-number">1</span>)
chr.clock &lt;- chronos(tree4, model = <span class="hljs-string">&quot;discrete&quot;</span>, control = ctrl)

cal &lt;- makeChronosCalib(tree4, node = <span class="hljs-string">&quot;root&quot;</span>, age.min = <span class="hljs-number">1</span>,
                 age.max = <span class="hljs-number">9</span>, interactive = <span class="hljs-literal">FALSE</span>, soft.bounds = <span class="hljs-literal">FALSE</span>)
<span class="hljs-comment"># ctrl &lt;- chronos.control(nb.rate.cat = 1)</span>
tree5 &lt;- chronos(tree4,calibration = cal)
plot(tree5)

tree5$tip.label &lt;- c(<span class="hljs-string">&quot;hcau&quot;</span> ,<span class="hljs-string">&quot;htur&quot;</span>,<span class="hljs-string">&quot;hflu&quot;</span>,<span class="hljs-string">&quot;hrha&quot;</span>, <span class="hljs-string">&quot;hmon&quot;</span> ,<span class="hljs-string">&quot;hsin&quot;</span> , <span class="hljs-string">&quot;hyun&quot;</span>)
</code></pre>
<h3 id="&#x8BA1;&#x7B97;&#x751F;&#x6001;&#x4F4D;&#x91CD;&#x53E0;&#x4E0E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x65F6;&#x95F4;&#x4E4B;&#x95F4;&#x7684;-&#x8054;&#x7CFB;">&#x8BA1;&#x7B97;&#x751F;&#x6001;&#x4F4D;&#x91CD;&#x53E0;&#x4E0E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x65F6;&#x95F4;&#x4E4B;&#x95F4;&#x7684; &#x8054;&#x7CFB;</h3>
<pre><code class="lang-R"><span class="hljs-comment">## 1.6 &#x8BA1;&#x7B97;&#x751F;&#x6001;&#x4F4D;&#x91CD;&#x53E0;&#x4E0E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x65F6;&#x95F4;&#x4E4B;&#x95F4;&#x7684; &#x8054;&#x7CFB;&#xFF1B;####</span>
<span class="hljs-comment"># &#x8BFB;&#x53D6;&#x751F;&#x6001;&#x4F4D;&#x91CD;&#x53E0;&#x6307;&#x6570;&#xFF1A;</span>
over &lt;- read.table(<span class="hljs-string">&quot;clipboard&quot;</span>, header = <span class="hljs-literal">T</span>, sep = <span class="hljs-string">&apos;\t&apos;</span>) %&gt;% as.data.frame()
nn &lt;- names(over)[-<span class="hljs-number">1</span>]
ov1 &lt;- over[,-<span class="hljs-number">1</span>]
row.names(ov1) &lt;- nn

<span class="hljs-comment"># &#x52A0;&#x8F7D;R&#x5305;&#x8BA1;&#x7B97;&#xFF1A;</span>
plot(da2)
png(<span class="hljs-string">&quot;&#x9F20;&#x674E;&#x6C99;&#x68D8;3.png&quot;</span>,width =<span class="hljs-number">3000</span>, height = <span class="hljs-number">1500</span>,res =<span class="hljs-number">300</span>)
<span class="hljs-comment"># age-range correlation</span>
x &lt;- age.range.correlation(phy = da2, overlap = ov1, n = <span class="hljs-number">100</span>)
<span class="hljs-comment"># plot average niche overlap versus node age</span>
plot(x$age.range.correlation,xlab = <span class="hljs-string">&quot;Age&quot;</span>,ylab = <span class="hljs-string">&quot;Overlap&quot;</span>)
<span class="hljs-comment"># add regression lines from Monte Carlo randomization</span>
apply(x$MonteCarlo.replicates, <span class="hljs-number">1</span>, abline, lwd = <span class="hljs-number">0.2</span>, col = <span class="hljs-string">&quot;grey50&quot;</span>)
<span class="hljs-comment"># add a regression line</span>
abline(x$linear.regression$coefficients,lwd = <span class="hljs-number">2</span>)
dev.off()
getwd()
<span class="hljs-comment">## &#x96F6;&#x5047;&#x8BBE;&#xFF1A;&#x4F4E;&#x751F;&#x6001;&#x4F4D;&#x91CD;&#x53E0;&#x53EF;&#x80FD;&#x4E0E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x8DDD;&#x79BB;&#x76F8;&#x5173;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x901A;&#x8FC7;&#x4E0D;&#x540C;&#x9009;&#x62E9;&#x8FDB;&#x884C;&#x751F;&#x6001;&#x4F4D;&#x5206;&#x5316;</span>
<span class="hljs-comment">## &#x7EDF;&#x8BA1;&#x7ED3;&#x679C;&#xFF1A;&#x7ED3;&#x679C;&#x4E2D;&#x6CA1;&#x6709;&#x68C0;&#x6D4B;&#x5230;&#x663E;&#x8457;&#x7684;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;</span>
<span class="hljs-comment"># $sig</span>
<span class="hljs-comment"># f    p</span>
<span class="hljs-comment"># (intercept) 0.17 0.34</span>
<span class="hljs-comment"># age         0.79 0.42</span>
da &lt;- x$age.range.correlation %&gt;% data.frame()
da2 &lt;- x$MonteCarlo.replicates %&gt;% data.frame()
names(da2) &lt;- c(<span class="hljs-string">&quot;Intercept&quot;</span>,<span class="hljs-string">&quot;Age&quot;</span>)

x$linear.regression
x$age.range.correlation


p1 &lt;- ggplot(data = da2,aes(x = Intercept)) + geom_histogram()+
  geom_vline(xintercept = <span class="hljs-number">0.17</span>, 
             linetype = <span class="hljs-string">&quot;longdash&quot;</span>,color= <span class="hljs-string">&quot;red&quot;</span>,lwd =<span class="hljs-number">1</span>) + 
  guides(fill = <span class="hljs-string">&quot;none&quot;</span>, alpha = <span class="hljs-literal">FALSE</span>) + 
  xlab(<span class="hljs-string">&quot;Intercept&quot;</span>) + ylab(<span class="hljs-string">&quot;&quot;</span>)+
  annotate(<span class="hljs-string">&quot;text&quot;</span>, x = <span class="hljs-number">0.5</span>, y = <span class="hljs-number">7.5</span>, label = <span class="hljs-string">&quot;P.value = 0.34&quot;</span>,
           size = <span class="hljs-number">5</span>, color = <span class="hljs-string">&quot;#22292F&quot;</span>) +
  ggtitle(<span class="hljs-string">&quot;Age-Overlap correlation from Monte Carlo&quot;</span>) + 
  theme(plot.title = element_text(hjust = <span class="hljs-number">0.5</span>))+
  theme_classic()

p2 &lt;- ggplot(data = da2,aes(x = Age)) + geom_histogram()+
  geom_vline(xintercept = -<span class="hljs-number">0.0189</span>  , 
             linetype = <span class="hljs-string">&quot;longdash&quot;</span>,color= <span class="hljs-string">&quot;red&quot;</span>,lwd =<span class="hljs-number">1</span>) + 
  guides(fill = <span class="hljs-string">&quot;none&quot;</span>, alpha = <span class="hljs-literal">FALSE</span>) + 
  xlab(<span class="hljs-string">&quot;Slope&quot;</span>) + ylab(<span class="hljs-string">&quot;&quot;</span>)+
  annotate(<span class="hljs-string">&quot;text&quot;</span>, x = <span class="hljs-number">0.01</span>, y = <span class="hljs-number">30</span>, label = <span class="hljs-string">&quot;P.value = 0.42&quot;</span>,
           size = <span class="hljs-number">5</span>, color = <span class="hljs-string">&quot;#22292F&quot;</span>) +
  ggtitle(<span class="hljs-string">&quot;Age-Overlap correlation from Monte Carlo&quot;</span>) + 
  theme(plot.title = element_text(hjust = <span class="hljs-number">0.5</span>))+
  theme_classic()

png(<span class="hljs-string">&quot;&#x9F20;&#x674E;&#x6C99;&#x68D8;6.png&quot;</span>,width =<span class="hljs-number">3000</span>, height = <span class="hljs-number">1500</span>,res =<span class="hljs-number">300</span>)
p2
dev.off()
</code></pre>
<h3 id="&#x7956;&#x5148;&#x6C14;&#x5019;&#x8010;&#x53D7;&#x6027;&#x91CD;&#x5EFA;">&#x7956;&#x5148;&#x6C14;&#x5019;&#x8010;&#x53D7;&#x6027;&#x91CD;&#x5EFA;</h3>
<pre><code class="lang-R"><span class="hljs-comment">## &#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x5C06;ml&#x6811;&#x8F6C;&#x4E3A;&#x8D85;&#x5EA6;&#x91CF;&#x6811;&#xFF1A;</span>
<span class="hljs-keyword">library</span>(ape)
ctrl &lt;- chronos.control(nb.rate.cat = <span class="hljs-number">1</span>)
chr.clock &lt;- chronos(tree4, model = <span class="hljs-string">&quot;discrete&quot;</span>, control = ctrl)

cal &lt;- makeChronosCalib(tree4, node = <span class="hljs-string">&quot;root&quot;</span>, age.min = <span class="hljs-number">1</span>,
                 age.max = <span class="hljs-number">9</span>, interactive = <span class="hljs-literal">FALSE</span>, soft.bounds = <span class="hljs-literal">FALSE</span>)
<span class="hljs-comment"># ctrl &lt;- chronos.control(nb.rate.cat = 1)</span>
tree5 &lt;- chronos(tree4,calibration = cal)
plot(tree5)

tree5$tip.label &lt;- c(<span class="hljs-string">&quot;hcau&quot;</span> ,<span class="hljs-string">&quot;htur&quot;</span>,<span class="hljs-string">&quot;hflu&quot;</span>,<span class="hljs-string">&quot;hrha&quot;</span>, <span class="hljs-string">&quot;hmon&quot;</span> ,<span class="hljs-string">&quot;hsin&quot;</span> , <span class="hljs-string">&quot;hyun&quot;</span>)

<span class="hljs-comment">## &#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x8BA1;&#x7B97;&#x5360;&#x6709;&#x7387;&#xFF1A;</span>
<span class="hljs-keyword">library</span>(phyloclim)
<span class="hljs-comment"># &#x6784;&#x5EFA;pno&#xFF1A;</span>
<span class="hljs-comment"># c(&quot;Hcau&quot; ,&quot;Hflu&quot;, &quot;Hmon&quot; ,&quot;Hrha&quot;,&quot;Hsin&quot; ,&quot;Htur&quot;, &quot;Hyun&quot;)</span>
<span class="hljs-comment"># &#x9700;&#x8981;&#x4F7F;&#x7528;R&#x8BA1;&#x7B97;&#x516D;&#x4E2A;&#x7269;&#x79CD;&#x7684;&#x5206;&#x5E03;&#x56FE;&#xFF1A;&#x4EC5;&#x57FA;&#x4E8E;&#x76F8;&#x540C;&#x7684;&#x53D8;&#x91CF;&#xFF1A;</span>
setwd(<span class="hljs-string">&quot;e:/sjdata/&quot;</span>)
tifcau &lt;- raster(<span class="hljs-string">&quot;./&#x5DE5;&#x4F5C;&#x7ED3;&#x679C;&#x603B;&#x7ED3;/&#x9F20;&#x674E;&#x6C99;&#x68D8;&#x79CD;&#x4E0B;&#x751F;&#x6001;&#x4F4D;&#x6BD4;&#x8F83;/sdm&#x5370;&#x8BC1;/scau/ense_mean.tif&quot;</span>)
tifflu &lt;- raster(<span class="hljs-string">&quot;./&#x5DE5;&#x4F5C;&#x7ED3;&#x679C;&#x603B;&#x7ED3;/&#x9F20;&#x674E;&#x6C99;&#x68D8;&#x79CD;&#x4E0B;&#x751F;&#x6001;&#x4F4D;&#x6BD4;&#x8F83;/sdm&#x5370;&#x8BC1;/sflu/ense_mean.tif&quot;</span>)
tifmon &lt;- raster(<span class="hljs-string">&quot;./&#x5DE5;&#x4F5C;&#x7ED3;&#x679C;&#x603B;&#x7ED3;/&#x9F20;&#x674E;&#x6C99;&#x68D8;&#x79CD;&#x4E0B;&#x751F;&#x6001;&#x4F4D;&#x6BD4;&#x8F83;/sdm&#x5370;&#x8BC1;/smon/smon_mean.tif&quot;</span>)
tifrha &lt;- raster(<span class="hljs-string">&quot;./&#x5DE5;&#x4F5C;&#x7ED3;&#x679C;&#x603B;&#x7ED3;/&#x9F20;&#x674E;&#x6C99;&#x68D8;&#x79CD;&#x4E0B;&#x751F;&#x6001;&#x4F4D;&#x6BD4;&#x8F83;/sdm&#x5370;&#x8BC1;/srha/ense_mean.tif&quot;</span>)
tifsin &lt;- raster(<span class="hljs-string">&quot;./&#x5DE5;&#x4F5C;&#x7ED3;&#x679C;&#x603B;&#x7ED3;/&#x9F20;&#x674E;&#x6C99;&#x68D8;&#x79CD;&#x4E0B;&#x751F;&#x6001;&#x4F4D;&#x6BD4;&#x8F83;/sdm&#x5370;&#x8BC1;/ssin/ense_mean.tif&quot;</span>)
tiftur &lt;- raster(<span class="hljs-string">&quot;./&#x5DE5;&#x4F5C;&#x7ED3;&#x679C;&#x603B;&#x7ED3;/&#x9F20;&#x674E;&#x6C99;&#x68D8;&#x79CD;&#x4E0B;&#x751F;&#x6001;&#x4F4D;&#x6BD4;&#x8F83;/sdm&#x5370;&#x8BC1;/stur/ense_mean.tif&quot;</span>)
tifyun &lt;- raster(<span class="hljs-string">&quot;./&#x5DE5;&#x4F5C;&#x7ED3;&#x679C;&#x603B;&#x7ED3;/&#x9F20;&#x674E;&#x6C99;&#x68D8;&#x79CD;&#x4E0B;&#x751F;&#x6001;&#x4F4D;&#x6BD4;&#x8F83;/sdm&#x5370;&#x8BC1;/syun/ense_mean.tif&quot;</span>)

<span class="hljs-comment">## &#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x8F6C;&#x5316;&#x51FD;&#x6570;&#xFF1A;</span>
bio10 &lt;- raster(<span class="hljs-string">&quot;./F2_ENVS/aseutif/bio10.tif&quot;</span>)
bio12 &lt;- raster(<span class="hljs-string">&quot;./F2_ENVS/aseutif/bio12.tif&quot;</span>)
bio11 &lt;- raster(<span class="hljs-string">&quot;./F2_ENVS/aseutif/bio11.tif&quot;</span>)
<span class="hljs-comment">## &#x5DE5;&#x4F5C;&#x601D;&#x8DEF;&#x91CD;&#x65B0;&#x8BBE;&#x5B9A;;</span>
<span class="hljs-comment"># &#x8FD8;&#x662F;&#x9700;&#x8981;&#x5C06;tif&#x6587;&#x4EF6;&#x8F6C;&#x4E3A;asc&#x6587;&#x4EF6;&#xFF1B;</span>
da &lt;- rbind(ssin,syun,scau,sflu,srha,smon,stur) %&gt;% data.frame()

writeRaster(bio11,<span class="hljs-string">&quot;E:/sjdata/temp/bio11.asc&quot;</span>,format = <span class="hljs-string">&quot;ascii&quot;</span>,overwrite=<span class="hljs-literal">TRUE</span>)
mcp &lt;- <span class="hljs-keyword">function</span> (xy) {
  <span class="hljs-keyword">library</span>(rgdal)
  xy &lt;- as.data.frame(coordinates(xy))
  coords.t &lt;- chull(xy[, <span class="hljs-number">1</span>], xy[, <span class="hljs-number">2</span>])
  xy.bord &lt;- xy[coords.t, ]
  xy.bord &lt;- rbind(xy.bord[nrow(xy.bord), ], xy.bord)
  <span class="hljs-keyword">return</span>(SpatialPolygons(list(Polygons(list(Polygon(as.matrix(xy.bord))), <span class="hljs-number">1</span>))))
}
toasc1 &lt;- <span class="hljs-keyword">function</span>(occ,tif){ <span class="hljs-comment">## </span>
  m1 &lt;- mcp(occ)
  m2 &lt;- rgeos::gBuffer(m1,width = <span class="hljs-number">0.1</span>)
  m3 &lt;- raster::crop(tif,m2)
  mm &lt;- paste0(deparse(substitute(occ)),deparse(substitute(tif)))

  rooute2 &lt;- paste0(<span class="hljs-string">&quot;E:/sjdata/temp/&quot;</span>,mm)
  dir.create(rooute2)
  rooute1 &lt;- paste0(rooute2,<span class="hljs-string">&quot;/&quot;</span>,mm,<span class="hljs-string">&quot;.asc&quot;</span>)
  writeRaster(m3,rooute1,format = <span class="hljs-string">&quot;ascii&quot;</span>,overwrite=<span class="hljs-literal">TRUE</span>)
  <span class="hljs-keyword">return</span>( rooute1)
}


bio10xx &lt;- toasc1(da,bio10)
bio12xx &lt;- toasc1(da,bio12)
bio11xx &lt;- toasc1(da,bio11)

toasc2 &lt;- <span class="hljs-keyword">function</span>(occ,tif){ <span class="hljs-comment">## </span>
  m1 &lt;- mcp(occ)
  m2 &lt;- rgeos::gBuffer(m1,width = <span class="hljs-number">0.1</span>)
  m3 &lt;- raster::crop(tif,m2)
  mm &lt;- paste0(deparse(substitute(occ)))

  rooute2 &lt;- paste0(<span class="hljs-string">&quot;E:/sjdata/temp/model/&quot;</span>)
  <span class="hljs-comment"># dir.create(rooute2)</span>
  rooute1 &lt;- paste0(rooute2,mm,<span class="hljs-string">&quot;.asc&quot;</span>)
  writeRaster(m3,rooute1,format = <span class="hljs-string">&quot;ascii&quot;</span>,overwrite=<span class="hljs-literal">TRUE</span>)
  <span class="hljs-keyword">return</span>( rooute2)
}
tifcau1 &lt;- toasc2(scau,tifcau)
tifflu1 &lt;- toasc2(sflu,tifflu)
tifrha1 &lt;- toasc2(srha,tifrha)
tifmon1 &lt;- toasc2(smon,tifmon)
tifsin1 &lt;- toasc2(ssin,tifsin)
tifyun1 &lt;- toasc2(syun,tifyun)
tiftur1 &lt;- toasc2(stur,tiftur)


path_model =  tifcau
path_bioclim = bio10cau

pno2 &lt;- <span class="hljs-keyword">function</span>(occ,tif1,tif2){
  toasc1 &lt;- <span class="hljs-keyword">function</span>(occ,tif1){ <span class="hljs-comment">## </span>
    m1 &lt;- mcp(occ)
    m2 &lt;- rgeos::gBuffer(m1,width = <span class="hljs-number">0.1</span>)
    m3 &lt;- raster::crop(tif,m2)
    mm &lt;- paste0(deparse(substitute(occ)),deparse(substitute(tif)))

    rooute2 &lt;- paste0(<span class="hljs-string">&quot;E:/sjdata/temp/&quot;</span>,mm)
    dir.create(rooute2)
    rooute1 &lt;- paste0(rooute2,<span class="hljs-string">&quot;/&quot;</span>,mm,<span class="hljs-string">&quot;.asc&quot;</span>)
    writeRaster(m3,rooute1,format = <span class="hljs-string">&quot;ascii&quot;</span>,overwrite=<span class="hljs-literal">TRUE</span>)
    <span class="hljs-keyword">return</span>( rooute1)
  }
  toasc2 &lt;- <span class="hljs-keyword">function</span>(occ,tif2){ <span class="hljs-comment">## </span>
    m1 &lt;- mcp(occ)
    m2 &lt;- rgeos::gBuffer(m1,width = <span class="hljs-number">0.1</span>)
    m3 &lt;- raster::crop(tif,m2)
    mm &lt;- paste0(deparse(substitute(occ)),deparse(substitute(tif)))

    rooute2 &lt;- paste0(<span class="hljs-string">&quot;E:/sjdata/temp/&quot;</span>,mm)
    dir.create(rooute2)
    rooute1 &lt;- paste0(rooute2,<span class="hljs-string">&quot;/&quot;</span>,mm,<span class="hljs-string">&quot;.asc&quot;</span>)
    writeRaster(m3,rooute1,format = <span class="hljs-string">&quot;ascii&quot;</span>,overwrite=<span class="hljs-literal">TRUE</span>)
    <span class="hljs-keyword">return</span>( rooute2)
  }
  bio10cau &lt;- toasc1(occ,tif1)
  tifcau &lt;- toasc2(occ,tif2)
  path_model =  tifcau
  path_bioclim = bio10cau
  cau &lt;- pno(path_bioclim, path_model, subset = <span class="hljs-literal">NULL</span>,
             bin_width = <span class="hljs-number">1</span>, bin_number = <span class="hljs-number">40</span>)
  <span class="hljs-keyword">return</span>(cau)
}

path_bioclim &lt;- bio10xx
path_model &lt;- <span class="hljs-string">&quot;E:/sjdata/temp/model/&quot;</span>
bio10 &lt;- pno(path_bioclim, path_model, subset = <span class="hljs-literal">NULL</span>,
    bin_width = <span class="hljs-number">1</span>, bin_number = <span class="hljs-number">40</span>)

path_bioclim &lt;- bio12xx
bio12va &lt;- pno(path_bioclim, path_model, subset = <span class="hljs-literal">NULL</span>,
             bin_width = <span class="hljs-number">1</span>, bin_number = <span class="hljs-number">40</span>)

path_bioclim &lt;- bio11xx
bio11va &lt;- pno(path_bioclim, path_model, subset = <span class="hljs-literal">NULL</span>,
               bin_width = <span class="hljs-number">1</span>, bin_number = <span class="hljs-number">40</span>)


<span class="hljs-comment"># write.csv(bio10,&quot;bio10va.csv&quot;)</span>
write.csv(bio12va,<span class="hljs-string">&quot;bio12va.csv&quot;</span>)

<span class="hljs-comment">## &#x7B2C;&#x4E09;&#x6B65;&#xFF1A;</span>
<span class="hljs-comment">## &#x91CD;&#x65B0;&#x4F18;&#x5316;&#x6C14;&#x5019;&#x5206;&#x5E03;</span>
bio10 &lt;- read.csv(<span class="hljs-string">&quot;./bio10va.csv&quot;</span>)[,-<span class="hljs-number">1</span>] %&gt;% round(<span class="hljs-number">3</span>)
bio12 &lt;- read.csv(<span class="hljs-string">&quot;./bio12va.csv&quot;</span>)[,-<span class="hljs-number">1</span>] %&gt;% round(<span class="hljs-number">3</span>)

clim2 = bio11va %&gt;% round(<span class="hljs-number">3</span>) %&gt;% data.frame()
names(clim2)

clim3 &lt;- cbind(clim2[,<span class="hljs-number">1</span>:<span class="hljs-number">2</span>],clim2[,<span class="hljs-number">7</span>],clim2[,<span class="hljs-number">3</span>],clim2[,<span class="hljs-number">5</span>],clim2[,<span class="hljs-number">4</span>],
               clim2[,<span class="hljs-number">6</span>],clim2[,<span class="hljs-number">8</span>]) %&gt;% data.frame()
names(clim3) &lt;- c(<span class="hljs-string">&quot;variable&quot;</span> ,<span class="hljs-string">&quot;hcau&quot;</span> ,<span class="hljs-string">&quot;htur&quot;</span>,<span class="hljs-string">&quot;hflu&quot;</span>,<span class="hljs-string">&quot;hrha&quot;</span>, <span class="hljs-string">&quot;hmon&quot;</span> ,<span class="hljs-string">&quot;hsin&quot;</span> , <span class="hljs-string">&quot;hyun&quot;</span>)

clim4 &lt;- cbind(clim2[,<span class="hljs-number">1</span>:<span class="hljs-number">2</span>],clim2[,<span class="hljs-number">7</span>],clim2[,<span class="hljs-number">3</span>],clim2[,<span class="hljs-number">5</span>],clim2[,<span class="hljs-number">4</span>],
               clim2[,<span class="hljs-number">6</span>],clim2[,<span class="hljs-number">8</span>]) %&gt;% data.frame()
names(clim4) &lt;- c(<span class="hljs-string">&quot;variable&quot;</span> ,<span class="hljs-string">&quot;hcau&quot;</span> ,<span class="hljs-string">&quot;htur&quot;</span>,<span class="hljs-string">&quot;hflu&quot;</span>,<span class="hljs-string">&quot;hrha&quot;</span>, <span class="hljs-string">&quot;hmon&quot;</span> ,<span class="hljs-string">&quot;hsin&quot;</span> , <span class="hljs-string">&quot;hyun&quot;</span>)
tail(clim4)
clim4$variable &lt;- log(clim4$variable)

clim5 &lt;- clim4[<span class="hljs-number">2</span>:<span class="hljs-number">30</span>,] %&gt;% data.frame()
clim5

<span class="hljs-comment">## &#x53EF;&#x89C6;&#x5316;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x7684;&#x5360;&#x6709;&#x7387; </span>
<span class="hljs-keyword">library</span>(phyloclim)
plotPNO(x = clim4,
        xlab = <span class="hljs-string">&quot;Annual Mean Temperature (degree C)&quot;</span>, wm = <span class="hljs-literal">TRUE</span>)

<span class="hljs-comment"># da5$posterior &lt;- c(0.9,0.8,0.8,0.86,0.8,0.86)</span>
<span class="hljs-comment"># </span>
<span class="hljs-comment"># ## &#x53EF;&#x89C6;&#x5316;&#x7956;&#x5148;&#x8010;&#x53D7;&#x6027; </span>
<span class="hljs-comment"># da5$posterior &lt;- c(1,1,1,1,1,1)</span>

<span class="hljs-comment"># estimate ancestral tolerances</span>
<span class="hljs-comment">## &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x5148;&#x9A8C;&#x6982;&#x7387;&#x8BA1;&#x7B97; </span>
<span class="hljs-comment">## &#x4F46;&#x6709;&#x6CA1;&#x6709;&#x5148;&#x9A8C;&#x6982;&#x7387;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x8010;&#x53D7;&#x6027;&#x6811;&#x578B;&#xFF1B;</span>
ac &lt;- anc.clim( target =tree5 ,pno=clim3, n = <span class="hljs-number">100</span>)
acbio12 &lt;- anc.clim( target =tree5 ,pno=clim5, n = <span class="hljs-number">100</span>,method = <span class="hljs-string">&quot;ML&quot;</span>)
acbio11 &lt;- anc.clim( target =tree5 ,pno=clim3, n = <span class="hljs-number">100</span>,method = <span class="hljs-string">&quot;ML&quot;</span>)
plot(tree5)
tree5$tip.label

head(bio11va)

<span class="hljs-comment">## &#x53EF;&#x89C6;&#x5316;&#x7ED3;&#x679C; ####</span>
png(<span class="hljs-string">&quot;&#x9F20;&#x674E;&#x6C99;&#x68D8;_bio12.png&quot;</span>,width =<span class="hljs-number">1600</span>, height = <span class="hljs-number">1350</span>,res =<span class="hljs-number">300</span>)
plotAncClim(acbio12 ,  tipmode = <span class="hljs-number">3</span>,col = c(<span class="hljs-string">&quot;pink&quot;</span>, <span class="hljs-string">&quot;purple&quot;</span>, <span class="hljs-string">&quot;blue&quot;</span>,<span class="hljs-string">&quot;red&quot;</span>),
            lwd =<span class="hljs-number">1.5</span>,cex =<span class="hljs-number">0.5</span>,
            ylab = <span class="hljs-string">&quot;log(BIO12)-&#x5E74;&#x964D;&#x96E8;&#x91CF;&quot;</span>,nchar = <span class="hljs-number">4</span>)
dev.off()


png(<span class="hljs-string">&quot;&#x9F20;&#x674E;&#x6C99;&#x68D8;_bio10.png&quot;</span>,width =<span class="hljs-number">1600</span>, height = <span class="hljs-number">1350</span>,res =<span class="hljs-number">300</span>)
plotAncClim(ac ,  tipmode = <span class="hljs-number">3</span>,col = c(<span class="hljs-string">&quot;pink&quot;</span>, <span class="hljs-string">&quot;purple&quot;</span>, <span class="hljs-string">&quot;blue&quot;</span>,<span class="hljs-string">&quot;red&quot;</span>),
            lwd =<span class="hljs-number">1.5</span>,cex =<span class="hljs-number">0.5</span>,
            ylab = <span class="hljs-string">&quot;BIO10-&#x6700;&#x70ED;&#x5B63;&#x8282;&#x7684;&#x5E73;&#x5747;&#x6E29;&#x5EA6;&quot;</span>,nchar = <span class="hljs-number">4</span>)
dev.off()

png(<span class="hljs-string">&quot;&#x9F20;&#x674E;&#x6C99;&#x68D8;_bio11.png&quot;</span>,width =<span class="hljs-number">1600</span>, height = <span class="hljs-number">1350</span>,res =<span class="hljs-number">300</span>)
plotAncClim(acbio11 ,  tipmode = <span class="hljs-number">3</span>,col = c(<span class="hljs-string">&quot;pink&quot;</span>, <span class="hljs-string">&quot;purple&quot;</span>, <span class="hljs-string">&quot;blue&quot;</span>,<span class="hljs-string">&quot;red&quot;</span>),
            lwd =<span class="hljs-number">1.5</span>,cex =<span class="hljs-number">0.5</span>,
            ylab = <span class="hljs-string">&quot;BIO11-&#x6700;&#x51B7;&#x5B63;&#x8282;&#x7684;&#x5E73;&#x5747;&#x6E29;&#x5EA6;&quot;</span>,nchar = <span class="hljs-number">4</span>)
dev.off()
</code></pre>
<h3 id="&#x591A;&#x5E8F;&#x5217;&#x5EFA;&#x6811;--&#x5408;&#x5E76;&#x3001;&#x6BD4;&#x5BF9;&#x3001;&#x5206;&#x53D1;">&#x591A;&#x5E8F;&#x5217;&#x5EFA;&#x6811;--&#x5408;&#x5E76;&#x3001;&#x6BD4;&#x5BF9;&#x3001;&#x5206;&#x53D1;</h3>
<pre><code class="lang-R"><span class="hljs-comment">## 1.8.1 &#x8BFB;&#x53D6;&#x53CA;&#x5408;&#x5E76;&#x591A;&#x5E8F;&#x5217;&#x6BD4;&#x5BF9;&#xFF1A; ####</span>
setwd(<span class="hljs-string">&quot;c:/Users/admin/Desktop/&#x6784;&#x67B6;&#x6C99;&#x68D8;&#x5C5E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;/&quot;</span>)
<span class="hljs-keyword">library</span>(ape)
nmaess &lt;- list.files(<span class="hljs-string">&quot;./&#x4E0B;&#x8F7D;&#x5E8F;&#x5217;2/&quot;</span>)
<span class="hljs-comment">## &#x6784;&#x5EFA;&#x57FA;&#x4E8E;5&#x4E2A;&#x57FA;&#x56E0;&#x7684;&#x5E8F;&#x5217;&#x6BD4;&#x5BF9; ####</span>
<span class="hljs-keyword">library</span>(seqinr)

nam2 &lt;- nmaess[c(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>,<span class="hljs-number">10</span>,<span class="hljs-number">13</span>,<span class="hljs-number">16</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">23</span>,<span class="hljs-number">26</span>,<span class="hljs-number">29</span>,<span class="hljs-number">32</span>,<span class="hljs-number">35</span>,<span class="hljs-number">38</span>,<span class="hljs-number">39</span>)]
rout &lt;- paste0(<span class="hljs-string">&quot;./&#x4E0B;&#x8F7D;&#x5E8F;&#x5217;2/&quot;</span>,nam2[<span class="hljs-number">1</span>])


da &lt;- data.frame()
<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">16</span>){
  rout &lt;- paste0(<span class="hljs-string">&quot;C:/Users/admin/Desktop/&#x6784;&#x67B6;&#x6C99;&#x68D8;&#x5C5E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;/&#x4E0B;&#x8F7D;&#x5E8F;&#x5217;2/&quot;</span>,nam2[i])
  daunlist(fa_seq2 ) &lt;- rbind(da,rout)
}

da2 &lt;- c(da)
names(da2) &lt;- <span class="hljs-string">&quot;nam&quot;</span>

<span class="hljs-keyword">library</span>(Biostrings)
files &lt;- da2$nam
fa_seq = lapply(files,readDNAStringSet)

gg1 &lt;- c()
te &lt;- <span class="hljs-keyword">function</span>(x){
  gg2 &lt;- fa_seq[[x]][<span class="hljs-number">5</span>]
  gg1 &lt;- c(gg1,gg2)
  <span class="hljs-keyword">return</span>(gg1)
}
ggg1 &lt;- lapply(<span class="hljs-number">1</span>:<span class="hljs-number">16</span>,te)

fa_seq2 = do.call(c,ggg1)
fa_seq3 &lt;- do.call(c,fa_seq2 )

<span class="hljs-comment">## 1.8.2&#x591A;&#x5E8F;&#x5217;&#x6BD4;&#x5BF9; ####</span>
<span class="hljs-comment">## &#x5BFC;&#x51FA;&#x5E8F;&#x5217; </span>
writeXStringSet(fa_seq3, file=<span class="hljs-string">&quot;gg1.fa&quot;</span>)
<span class="hljs-comment">## &#x8BFB;&#x8FDB;&#x5E8F;&#x5217;&#xFF1A;</span>
<span class="hljs-comment"># myseq &lt;- readAAStringSet(&quot;gg1.fa&quot;, format=&quot;fasta&quot;,</span>
<span class="hljs-comment">#                          nrec=-1L, skip=0L, seek.first.rec=FALSE, use.names=TRUE)</span>
<span class="hljs-keyword">library</span>(muscle)
g1 &lt;- muscle::muscle(fa_seq3)
g2 &lt;- muscle::muscle(fa_seq3)
g3 &lt;- muscle::muscle(fa_seq3)
g4 &lt;- muscle::muscle(fa_seq3)
g5 &lt;- muscle::muscle(fa_seq3)

<span class="hljs-comment">## 1.8.3 &#x91CD;&#x65B0;&#x5C06;&#x5E8F;&#x5217;&#x62FC;&#x63A5;&#x8D77;&#x6765; ####</span>
<span class="hljs-comment"># nam2 </span>
outfa &lt;- <span class="hljs-keyword">function</span>(x){
  nn &lt;- c(g1@unmasked[x],g2@unmasked[x],g3@unmasked[x],
          g4@unmasked[x],g5@unmasked[x])
  writeXStringSet(nn, file= paste0(nam2[x]))
}
lapply(<span class="hljs-number">1</span>:<span class="hljs-number">16</span>,outfa)


<span class="hljs-comment">## 1.8.4 &#x5E8F;&#x5217;&#x6784;&#x6811; ####</span>
<span class="hljs-comment"># 1.8.4.1&#x8BFB;&#x53D6;&#x5E8F;&#x5217; ####</span>
nnmm &lt;- list.files(<span class="hljs-string">&quot;./bidui/&quot;</span>)
da &lt;- data.frame()
<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">15</span>){
  rout &lt;- paste0(<span class="hljs-string">&quot;C:/Users/admin/Desktop/&#x6784;&#x67B6;&#x6C99;&#x68D8;&#x5C5E;&#x7CFB;&#x7EDF;&#x53D1;&#x80B2;&#x6811;/bidui/&quot;</span>,nnmm[i])
  da &lt;- rbind(da,rout)
}
files &lt;- c(da)
names(files) &lt;- <span class="hljs-string">&quot;names&quot;</span>

<span class="hljs-keyword">library</span>(Biostrings)

fa_seq = lapply(files,readDNAStringSet)
names(fa_seq$names) =   nnmm

writeXStringSet(fa_seq$names, file=<span class="hljs-string">&quot;biduiclean.fa&quot;</span>)
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="12. 系统发育与SDM说明.html" class="navigation navigation-prev " aria-label="Previous page: 12.系统发育与SDM">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="12.2 研究R包.html" class="navigation navigation-next " aria-label="Next page: 12.2 研究R包">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"12.1 研究思路","level":"1.13.1","depth":2,"next":{"title":"12.2 研究R包","level":"1.13.2","depth":2,"path":"12. 系统发育与SDM/12.2 研究R包.md","ref":"12. 系统发育与SDM/12.2 研究R包.md","articles":[]},"previous":{"title":"12.系统发育与SDM","level":"1.13","depth":1,"path":"12. 系统发育与SDM/12. 系统发育与SDM说明.md","ref":"12. 系统发育与SDM/12. 系统发育与SDM说明.md","articles":[{"title":"12.1 研究思路","level":"1.13.1","depth":2,"path":"12. 系统发育与SDM/12.1 研究思路.md","ref":"12. 系统发育与SDM/12.1 研究思路.md","articles":[]},{"title":"12.2 研究R包","level":"1.13.2","depth":2,"path":"12. 系统发育与SDM/12.2 研究R包.md","ref":"12. 系统发育与SDM/12.2 研究R包.md","articles":[]},{"title":"12.3 经典研究案例","level":"1.13.3","depth":2,"path":"12. 系统发育与SDM/12.3 经典研究案例.md","ref":"12. 系统发育与SDM/12.3 经典研究案例.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["github-buttons@2.1.0","edit-link","toggle-chapters","livereload"],"root":".","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"livereload":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"github-buttons":{"repo":"nicheerfeng/Nichefbook","types":["star"],"size":"small"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","base":"https://github.com/nicheerfeng/Nichefbook/edit/main"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"toggle-chapters":{}},"theme":"default","author":"nicheerfeng","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"NICHE MODEL 中文指南-RCODING","language":"zh-hans","gitbook":"*","description":"Niche"},"file":{"path":"12. 系统发育与SDM/12.1 研究思路.md","mtime":"2021-09-15T13:01:15.949Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-09-22T14:10:03.582Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

